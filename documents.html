<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√†i li·ªáu h·ªçc t·∫≠p - H·ªá th·ªëng qu·∫£n l√Ω l·ªõp h·ªçc</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Qu·∫£n l√Ω l·ªõp h·ªçc</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="dashboard.html" class="nav-item">
                    <span>üè†</span> Trang ch·ªß
                </a>
                <a href="students.html" class="nav-item">
                    <span>üë•</span> Qu·∫£n l√Ω sinh vi√™n
                </a>
                <a href="documents.html" class="nav-item active">
                    <span>üìö</span> T√†i li·ªáu h·ªçc t·∫≠p
                </a>
                <a href="attendance.html" class="nav-item">
                    <span>üìÖ</span> ƒêi·ªÉm danh
                </a>
                <a href="grades.html" class="nav-item">
                    <span>üßÆ</span> ƒêi·ªÉm s·ªë
                </a>
            </nav>
            <div class="sidebar-footer">
                <button id="logoutBtn" class="btn btn-secondary">ƒêƒÉng xu·∫•t</button>
            </div>
        </aside>
        
        <main class="main-content">
            <header class="page-header">
                <h1>Qu·∫£n l√Ω t√†i li·ªáu h·ªçc t·∫≠p</h1>
                <div class="user-info">
                    <span id="userName"></span>
                </div>
            </header>
            
            <div class="content">
                <div class="card">
                    <h2>T·∫£i l√™n t√†i li·ªáu m·ªõi</h2>
                    <form id="documentForm">
                        <div class="form-group">
                            <label for="documentFile">Ch·ªçn file</label>
                            <input type="file" id="documentFile" accept=".pdf,.doc,.docx,.ppt,.pptx,.jpg,.jpeg,.png" required>
                        </div>
                        <div class="form-group">
                            <label for="documentName">T√™n t√†i li·ªáu</label>
                            <input type="text" id="documentName" required>
                        </div>
                        <button type="submit" class="btn btn-primary">T·∫£i l√™n</button>
                    </form>
                </div>
                
                <div class="card">
                    <h2>Danh s√°ch t√†i li·ªáu</h2>
                    <table id="documentsTable">
                        <thead>
                            <tr>
                                <th>T√™n file</th>
                                <th>Ng∆∞·ªùi ƒëƒÉng</th>
                                <th>Ng√†y ƒëƒÉng</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="documentsTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>
    
    <script src="app.js"></script>
    <script>
        checkAuth();
        
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        document.getElementById('userName').textContent = currentUser.fullname;
        document.getElementById('logoutBtn').addEventListener('click', logout);
        
        let documents = JSON.parse(localStorage.getItem('documents')) || [];
        
        function renderDocuments() {
            const tbody = document.getElementById('documentsTableBody');
            tbody.innerHTML = '';
            
            documents.forEach(doc => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${doc.name}</td>
                    <td>${doc.uploader}</td>
                    <td>${new Date(doc.date).toLocaleDateString('vi-VN')}</td>
                    <td>
                        <button class="btn btn-small btn-primary" onclick="downloadDocument(${doc.id})">T·∫£i xu·ªëng</button>
                        <button class="btn btn-small btn-danger" onclick="deleteDocument(${doc.id})">X√≥a</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        document.getElementById('documentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const fileInput = document.getElementById('documentFile');
            const name = document.getElementById('documentName').value;
            const file = fileInput.files[0];
            
            if (file) {
                const newDocument = {
                    id: Date.now(),
                    name: name,
                    fileName: file.name,
                    uploader: currentUser.fullname,
                    date: new Date().toISOString()
                };
                
                documents.push(newDocument);
                localStorage.setItem('documents', JSON.stringify(documents));
                renderDocuments();
                this.reset();
                alert('T·∫£i l√™n t√†i li·ªáu th√†nh c√¥ng!');
            }
        });
        
        window.downloadDocument = function(id) {
            const doc = documents.find(d => d.id === id);
            if (doc) {
                alert(`ƒêang t·∫£i xu·ªëng: ${doc.fileName}\n(Ch·ª©c nƒÉng m√¥ ph·ªèng - kh√¥ng c√≥ file th·ª±c t·∫ø)`);
            }
        };
        
        window.deleteDocument = function(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t√†i li·ªáu n√†y?')) {
                documents = documents.filter(d => d.id !== id);
                localStorage.setItem('documents', JSON.stringify(documents));
                renderDocuments();
            }
        };
        
        renderDocuments();
    </script>
</body>
</html>
